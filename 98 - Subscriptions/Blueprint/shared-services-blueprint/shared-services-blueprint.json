{
  "properties": {
    "parameters": {
      "organization": {
        "type": "string",
        "metadata": {
          "displayName": "Organization name (e.g. Contoso), must be unique"
        },
        "defaultValue": "contoso"
      },
      "log-analytics_service-tier": {
        "type": "string",
        "metadata": {
          "displayName": "Service tier",
          "description": "Service tier: Free, Standalone, PerNode or PerGB2018"
        },
        "defaultValue": "PerGB2018",
        "allowedValues": [
          "Free",
          "Standalone",
          "PerNode",
          "PerGB2018"
        ]
      },
      "log-analytics_data-retention": {
        "type": "int",
        "metadata": {
          "displayName": "Log retention in days",
          "description": "Number of days data will be retained for"
        },
        "defaultValue": 30,
        "allowedValues": []
      },
      "log-analytics_location": {
        "type": "string",
        "metadata": {
          "displayName": "Location",
          "description": "Region used when establishing the workspace"
        },
        "defaultValue": "West Europe",
        "allowedValues": [
          "Australia Southeast",
          "Canada Central",
          "Central India",
          "East US",
          "Japan East",
          "Southeast Asia",
          "UK South",
          "West Europe",
          "West US 2"
        ]
      },
      "logAnalyticstemplate_account-sku": {
        "type": "string",
        "metadata": {
          "displayName": "account-sku (Log Analytics template)",
          "description": "Automation Account SKU: Free or Basic"
        },
        "defaultValue": "Basic",
        "allowedValues": [
          "Free",
          "Basic"
        ]
      },
      "azure-firewall_azure-firewall-private-ip": {
        "type": "string",
        "metadata": {
          "displayName": "Azure firewall private IP"
        },
        "defaultValue": "10.0.254.4",
        "allowedValues": []
      },
      "azure-firewall_logs-retention-in-days": {
        "type": "int",
        "metadata": {
          "displayName": "Log retention in days",
          "description": "Specifies the number of days that logs will be kept for; a value of 0 will retain data indefinitely"
        },
        "defaultValue": 30,
        "allowedValues": []
      },
      "vnet_vnet-address-prefix": {
        "type": "string",
        "metadata": {
          "displayName": "Virtual Network address prefix"
        },
        "defaultValue": "10.0.240.0/20",
        "allowedValues": []
      },
      "vnet_enable-ddos-protection": {
        "type": "string",
        "metadata": {
          "displayName": "Enable Virtual Network DDoS protection",
          "description": "Determines whether or not DDoS Protection is enabled in the Virtual Network"
        },
        "defaultValue": "true",
        "allowedValues": []
      },
      "vnet_sharedsvcs-subnet-address-prefix": {
        "type": "string",
        "metadata": {
          "displayName": "Shared services subnet address prefix",
          "description": "Value used in Virtual Network / Route Table, Jumpbox and Active Directory Domain Services templates"
        },
        "defaultValue": "10.0.240.0/24",
        "allowedValues": []
      },
      "vnet_dmz-subnet-address-prefix": {
        "type": "string",
        "metadata": {
          "displayName": "DMZ subnet address prefix"
        },
        "defaultValue": "10.0.241.0/24",
        "allowedValues": []
      },
      "vnet_app-gateway-subnet-address-prefix": {
        "type": "string",
        "metadata": {
          "displayName": "Application Gateway subnet address prefix"
        },
        "defaultValue": "10.0.242.0/24",
        "allowedValues": []
      },
      "vnet_azure-firewall-subnet-address-prefix": {
        "type": "string",
        "metadata": {
          "displayName": "Azure Firewall subnet address prefix"
        },
        "defaultValue": "10.0.254.0/24",
        "allowedValues": []
      },
      "vnet_logs-retention-in-days": {
        "type": "int",
        "metadata": {
          "displayName": "Log retention in days",
          "description": "Specifies the number of days that logs will be kept for; a value of 0 will retain data indefinitely"
        },
        "defaultValue": 30,
        "allowedValues": []
      },
      "hub-vnet-resource-id": {
        "type": "string",
        "metadata": {
          "displayName": "Hub Virtual Network resource id",
          "description": "Enable access to centralized express route gateways"
        },
        "defaultValue": "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroup}/providers/Microsoft.Network/virtualNetworks/{vnetName}",
        "allowedValues": []
      },
      "nsg_logs-retention-in-days": {
        "type": "int",
        "metadata": {
          "displayName": "Log retention in days",
          "description": "Specifies the number of days that logs will be kept for; a value of 0 will retain data indefinitely"
        },
        "defaultValue": 30,
        "allowedValues": []
      },
      "keyvault_jumpbox-local-admin-username": {
        "type": "string",
        "metadata": {
          "displayName": "Jumpbox admin username",
          "description": "The username used to access jumpbox VM"
        },
        "defaultValue": "jb-admin-user",
        "allowedValues": []
      },
      "keyvault_jumpbox-local-admin-user-password": {
        "type": "string",
        "metadata": {
          "displayName": "Jumpbox admin ssh key or password",
          "description": "Jumpbox admin user's ssh key or password"
        },
        "allowedValues": []
      },
      "keyvault_ad-domain-admin-username": {
        "type": "string",
        "metadata": {
          "displayName": "Domain admin username",
          "description": "Username used to access Active Directory VM and to join other VMs to a domain"
        },
        "defaultValue": "domain-admin-user",
        "allowedValues": []
      },
      "keyvault_ad-domain-admin-user-password": {
        "type": "string",
        "metadata": {
          "displayName": "Domain admin password",
          "description": "Domain admin user's password"
        },
        "allowedValues": []
      },
      "keyvault_deployment-user-object-id": {
        "type": "string",
        "metadata": {
          "displayName": "AAD object ID",
          "description": "AAD object ID of the user that requires access to Key Vault. To retrieve this value go to Microsoft Azure Portal > Azure Active Directory > Users > (user) and copy the Userâ€™s Object ID"
        },
        "allowedValues": []
      },
      "keyvault_logs-retention-in-days": {
        "type": "int",
        "metadata": {
          "displayName": "Log retention in days",
          "description": "Specifies the number of days that logs will be kept for; a value of 0 will retain data indefinitely"
        },
        "defaultValue": 30,
        "allowedValues": []
      },
      "keyvault_vault-sku": {
        "type": "string",
        "metadata": {
          "displayName": "Key Vault SKU",
          "description": "Specifies the SKU for the vault"
        },
        "defaultValue": "Premium",
        "allowedValues": [
          "Premium"
        ]
      },
      "resource-group-location": {
        "type": "string",
        "metadata": {
          "displayName": "Shared services location"
        },
        "defaultValue": "westeurope",
        "allowedValues": [
          "eastasia",
          "southeastasia",
          "centralus",
          "eastus",
          "eastus2",
          "westus",
          "northcentralus",
          "southcentralus",
          "northeurope",
          "westeurope",
          "japanwest",
          "japaneast",
          "brazilsouth",
          "australiaeast",
          "australiasoutheast",
          "southindia",
          "centralindia",
          "westindia",
          "canadacentral",
          "canadaeast",
          "uksouth",
          "ukwest",
          "westcentralus",
          "westus2",
          "koreacentral",
          "koreasouth",
          "francecentral",
          "francesouth",
          "australiacentral",
          "australiacentral2"
        ]
      }
    },
    "resourceGroups": {
      "ResourceGroup": {
        "name": "[concat(parameters('organization'),'-sharedsvcs-log-rg')]",
        "location": "[parameters('resource-group-location')]",
        "metadata": {
          "displayName": "Log Analytics resource group"
        },
        "dependsOn": []
      },
      "ResourceGroup2": {
        "name": "[concat(parameters('organization'),'-sharedsvcs-net-rg')]",
        "location": "[parameters('resource-group-location')]",
        "metadata": {
          "displayName": "Network resource group"
        },
        "dependsOn": []
      },
      "ResourceGroup3": {
        "name": "[concat(parameters('organization'),'-sharedsvcs-kv-rg')]",
        "location": "[parameters('resource-group-location')]",
        "metadata": {
          "displayName": "Key Vault resource group"
        },
        "dependsOn": []
      }
    },
    "targetScope": "subscription",
    "status": {
      "timeCreated": "2019-06-05T18:47:56+02:00",
      "lastModified": "2019-06-05T18:51:15+02:00"
    },
    "displayName": "ISO 27001: Shared Services",
    "description": "Deploys and configures Azure foundation infrastructure for shared-services workloads"
  },
  "type": "Microsoft.Blueprint/blueprints"
}
